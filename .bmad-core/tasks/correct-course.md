# 纠正方向任务(Correct Course Task)

## 目的(Purpose)

- 使用 `.bmad-core/checklists/change-checklist` 指导对变更触发器的结构化响应
- 在清单结构指导下分析变更对 epic、项目工件和 MVP 的影响
- 探索潜在解决方案（如调整范围、回滚元素、重新范围特性），按清单提示
- 基于分析起草对任何受影响项目工件的具体、可操作的建议更新（如 epic、用户故事、PRD 章节、架构文档章节）
- 生成包含影响分析和明确起草建议编辑的整合"Sprint 变更提案"文档，供用户审查和批准
- 如变更性质需要其他核心代理（如 PM 或架构师）进行根本性重新规划，确保清晰的交接路径

## 指令(Instructions)

### 1. 初始设置和模式选择(Initial Setup & Mode Selection)

- **确认任务和输入：**
    - 向用户确认正在启动"纠正方向任务"（变更导航和集成）
    - 验证变更触发器并确保您有用户对问题及其感知影响的初始解释
    - 确认访问所有相关项目工件（如 PRD、Epic/故事、架构文档、UI/UX 规范）以及关键的 `.bmad-core/checklists/change-checklist`
- **建立交互模式：**
    - 询问用户对此任务的偏好交互模式：
        - **"增量式（默认和推荐）：** 我们是否应该逐节处理 change-checklist，讨论发现并协作起草每个相关部分的建议变更，然后再进入下一节？这允许详细的逐步精炼。"
        - **"YOLO 模式（批处理）：** 或者，您是否希望我基于清单进行更批量的分析，然后呈现整合的发现和建议变更集以供更广泛的审查？这对初始评估可能更快，但可能需要更广泛地审查组合提案。"
    - 用户选择后，确认所选模式，然后告知用户："我们现在将使用 change-checklist 分析变更并起草建议更新。我将根据我们选择的交互模式指导您完成清单项目。"

### 2. 执行清单分析（按交互模式迭代或批量）(Execute Checklist Analysis (Iteratively or Batched, per Interaction Mode))

- 系统性地处理 change-checklist 的第 1-4 节（通常涵盖变更上下文、Epic/故事影响分析、工件冲突解决和路径评估/建议）
- 对每个清单项目或逻辑项目组（取决于交互模式）：
    - 向用户呈现清单中的相关提示或考虑
    - 请求必要信息并主动分析相关项目工件（PRD、epic、架构文档、故事历史等）以评估影响
    - 与用户讨论每个项目的发现
    - 记录每个清单项目的状态（如 `[x] 已处理`、`[N/A]`、`[!] 需要进一步行动`）以及任何相关说明或决策
    - 协作同意清单第 4 节提示的"推荐前进路径"

### 3. 起草建议变更（迭代或批量）(Draft Proposed Changes (Iteratively or Batched))

- 基于完成的清单分析（第 1-4 节）和商定的"推荐前进路径"（排除需要根本性重新规划的场景，这些场景需要立即交接给 PM/架构师）：
    - 识别需要更新的具体项目工件（如具体 epic、用户故事、PRD 章节、架构文档组件、图表）
    - **为每个识别的工件直接明确起草建议变更。** 示例包括：
        - 修订用户故事文本、验收标准或优先级
        - 在 epic 内添加、移除、重新排序或拆分用户故事
        - 建议修改的架构图表片段（如提供更新的 Mermaid 图表块或对现有图表的清晰文本描述）
        - 更新 PRD 或架构文档中的技术列表、配置详情或具体章节
        - 如需要起草新的小型支持工件（如特定决策的简要附录）
    - 如为"增量模式"，在起草时与用户讨论并精炼这些建议编辑
    - 如为"YOLO 模式"，编译所有起草的编辑以供下一步呈现

### 4. 生成带编辑的"Sprint 变更提案"(Generate "Sprint Change Proposal" with Edits)

- 将完整的 change-checklist 分析（涵盖第 1-4 节的发现）和所有商定的建议编辑（来自指令 3）综合到标题为"Sprint 变更提案"的单一文档中。此提案应与 change-checklist 第 5 节建议的结构一致
- 提案必须清晰呈现：
    - **分析摘要：** 原始问题的简明概述、其分析影响（对 epic、工件、MVP 范围）以及所选前进路径的理由
    - **具体建议编辑：** 对每个受影响的工件，清晰显示或描述确切变更（如"将故事 X.Y 从：[旧文本] 更改为：[新文本]"、"向故事 A.B 添加新验收标准：[新 AC]"、"按如下更新架构文档第 3.2 节：[新/修改文本或图表描述]"）
- 向用户呈现"Sprint 变更提案"的完整草稿以供最终审查和反馈。纳入用户请求的任何最终调整

### 5. 最终确定和确定下一步(Finalize & Determine Next Steps)

- 获得用户对"Sprint 变更提案"的明确批准，包括其中记录的所有具体编辑
- 向用户提供最终确定的"Sprint 变更提案"文档
- **基于批准变更的性质：**
    - **如批准的编辑充分解决变更并可直接实施或由 PO/SM 组织：** 说明"纠正方向任务"在分析和变更提案方面已完成，用户现在可以继续实施或记录这些变更（如更新实际项目文档、待办事项）。如适当建议交接给 PO/SM 代理进行待办事项组织
    - **如分析和建议路径（按清单第 4 节和可能的第 6 节）表明变更需要更根本的重新规划（如重大范围变更、主要架构重做）：** 明确说明此结论。建议用户下一步涉及参与主要 PM 或架构师代理，使用"Sprint 变更提案"作为该更深层重新规划工作的关键输入和上下文

## 输出交付物(Output Deliverables)

- **主要：** "Sprint 变更提案"文档（markdown 格式）。此文档将包含：
    - change-checklist 分析摘要（问题、影响、所选路径的理由）
    - 对所有受影响项目工件的具体、明确起草的建议编辑
- **隐含：** 带注释的 change-checklist（或其完成记录），反映过程中的讨论、发现和决策
